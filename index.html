<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>課文理解測驗</title>
    <!-- 載入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 使用 Inter 字體 */
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }
        /* 自訂按鈕懸停效果 */
        .btn {
            @apply px-6 py-3 rounded-lg shadow-md transition-all duration-300 ease-in-out text-white font-semibold;
        }
        .btn-primary {
            @apply bg-blue-600 hover:bg-blue-700 hover:shadow-lg transform hover:-translate-y-0.5;
        }
        .btn-secondary {
            @apply bg-gray-500 hover:bg-gray-600 hover:shadow-lg transform hover:-translate-y-0.5;
        }
        .btn-lesson {
            @apply w-full h-24 bg-white border-2 border-blue-400 text-blue-700 font-bold rounded-lg shadow-lg flex items-center justify-center text-center p-2 transition-all duration-300 ease-in-out;
            @apply hover:bg-blue-100 hover:shadow-xl hover:border-blue-600 transform hover:scale-105;
        }
        /* 選項按鈕 */
        .option-btn {
            @apply w-full text-left p-3 my-2 border-b-4 border-gray-400 rounded-lg shadow-md bg-gray-200 text-gray-800 transition-all duration-150 ease-in-out;
            @apply hover:bg-gray-300 transform hover:-translate-y-0.5;
            @apply active:bg-gray-400 active:border-b-2 active:translate-y-0.5;
        }
        /* 選項按鈕 - 禁用狀態 */
        .option-btn:disabled {
            @apply opacity-70 cursor-not-allowed bg-gray-200 hover:bg-gray-200 transform-none active:transform-none border-b-4;
        }
        /* 選項按鈕內的 "按鍵" (A, B, C) */
        .option-btn .keycap {
             @apply inline-block bg-gray-600 text-white rounded-md px-3 py-1 font-bold mr-4 transition-all duration-150;
        }
        .option-btn:hover .keycap {
            @apply bg-gray-700;
        }

        /* 選項按鈕 - 答對 */
        .option-btn.correct {
            @apply bg-green-200 border-green-500 text-green-900 font-bold;
            @apply opacity-100 transform-none active:transform-none;
        }
        .option-btn.correct .keycap {
            @apply bg-green-600 text-white;
        }

        /* 選項按鈕 - 答錯 */
        .option-btn.wrong {
            @apply bg-red-200 border-red-500 text-red-900 font-bold;
            @apply opacity-100 transform-none active:transform-none;
        }
        .option-btn.wrong .keycap {
            @apply bg-red-600 text-white;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div id="app-container" class="w-full max-w-2xl bg-white rounded-2xl shadow-2xl p-6 md:p-10 mx-auto">
        
        <!-- 應用程式內容將由 JavaScript 動態插入 -->
        <div id="content-area">
            <!-- 初始畫面會顯示在這裡 -->
        </div>

    </div>

    <script>
        // --- 測驗資料庫 ---
        // 根據1-12課課文，依閱讀四層次出題
        const quizData = {
            '1': {
                title: '第一課：我的心情',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '在「我的心情」這課中，作者說難過的時候，心裡會發生什麼事？',
                        options: [
                            '颳起冷冷的風',
                            '烏雲密布，下起傾盆大雨',
                            '一會兒閃電，一會兒打雷',
                            '充滿溫暖的陽光'
                        ],
                        correct: 1,
                        explanation: '課文提到：「難過的時候，心裡烏雲密布，下起傾盆大雨」，這是直接從課文中找到的答案。'
                    },
                    {
                        level: 1, // 文義理解
                        text: '作者生氣的時候，心裡感覺怎麼樣？',
                        options: [
                            '好想躲起來',
                            '一會兒閃電，一會兒打雷',
                            '忍不住哭出來',
                            '心裡充滿溫暖'
                        ],
                        correct: 1,
                        explanation: '課文提到：「生氣的時候，心裡一會兒閃電，一會兒打雷」。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '作者為什麼說「我的心情像天氣」？',
                        options: [
                            '因為天氣預報很準',
                            '因為他出門都看天氣',
                            '因為心情會像天氣一樣有晴天、下雨、打雷等不同變化',
                            '因為他喜歡彩虹'
                        ],
                        correct: 2,
                        explanation: '作者用颳風、閃電、打雷、下雨、放晴來比喻害怕、生氣、難過、開心等情緒，所以說心情像天氣一樣多變。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '為什麼作者開心的時候會「笑出來」，難過的時候會「哭出來」？',
                        options: [
                            '因為他很愛表演',
                            '因為天氣的關係',
                            '因為這是情緒很自然的表現',
                            '因為他想嚇人'
                        ],
                        correct: 2,
                        explanation: '詩中用「忍不住」來形容笑出來和哭出來，表示這些是開心或難過時很自然的反應。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '作者最後提到「雨後放晴，會出現美麗的彩虹」，這句話可能想告訴我們什麼？',
                        options: [
                            '下雨後一定看得到彩虹',
                            '壞心情過去後，就會迎來好心情',
                            '颱風天不要出門',
                            '作者最喜歡彩虹'
                        ],
                        correct: 1,
                        explanation: '「雨後放晴」比喻壞心情結束，「彩虹」比喻好心情或希望。作者用這個比喻來表達樂觀的看法，即使有不好的情緒，最後還是會變好的。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '如果你現在覺得「心裡颳起冷冷的風」，你最想做什麼事？',
                        options: [
                            '找朋友一起玩',
                            '大叫出來',
                            '找個安全的地方躲起來或找人幫忙',
                            '忍不住笑出來'
                        ],
                        correct: 2,
                        explanation: '「心裡颳起冷冷的風」是害怕的時候，這時找個安全的地方或尋求協助是很好的做法。'
                    }
                ]
            },
            '2': {
                title: '第二課：彩色的天空',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '在「彩色的天空」這課中，「我」的開學新希望最後寫了什麼？',
                        options: [
                            '我要當班長',
                            '我希望轉學',
                            '我要跟同學一起快樂學習！',
                            '我什麼都沒寫'
                        ],
                        correct: 2,
                        explanation: '課文最後提到：「我開心的在卡片上寫出：『我要跟同學一起快樂學習！』」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '老師發給大家「小雲朵卡片」是要做什麼用的？',
                        options: [
                            '畫畫用的',
                            '寫上開學新希望',
                            '傳紙條用的',
                            '做美勞'
                        ],
                        correct: 1,
                        explanation: '課文第一句提到：「老師給我們小雲朵卡片，要大家寫上開學新希望。」'
                    },
                    {
                        level: 2, // 推論層次
                        text: '「我」一開始為什麼想不出新希望，還覺得很緊張？',
                        options: [
                            '因為老師很兇',
                            '因為他是轉學生，和同學還不熟',
                            '因為他沒有帶筆',
                            '因為他想睡覺'
                        ],
                        correct: 1,
                        explanation: '課文提到：「因為我是轉學生，和同學還不熟，不知道可以問誰」，這讓他感到緊張。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '為什麼「我」的心情最後也「快樂得跳起舞來」？',
                        options: [
                            '因為放學了',
                            '因為老師稱讚他',
                            '因為他的緊張消失了，也感覺和同學變熟了',
                            '因為他寫完作業了'
                        ],
                        correct: 2,
                        explanation: '因為下課後同學們主動來跟他說話，讓他「不知不覺中，緊張的心情消失了」，並且開心寫下新希望。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '為什麼課文的標題是「彩色的天空」？',
                        options: [
                            '因為那天下雨，出現了彩虹',
                            '因為教室的牆壁是彩色的',
                            '因為老師把大家彩色的希望卡片掛起來，像天空一樣',
                            '因為「我」畫了彩色的天空'
                        ],
                        correct: 2,
                        explanation: '課文結尾說：「一朵朵彩色的雲(卡片)好像在天空跳舞」，作者用「彩色的天空」來比喻教室裡充滿大家希望的景象。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '如果你是「我」的同學，你會怎麼幫助剛轉學來的「我」？',
                        options: [
                            '不理他',
                            '下課後主動找他說話，介紹自己',
                            '跟老師說他很奇怪',
                            '只跟自己的朋友玩'
                        ],
                        correct: 1,
                        explanation: '就像課文中的班長和同學一樣，主動釋出善意，能幫助新同學更快融入環境。'
                    }
                ]
            },
            '3': {
                title: '第三課：國王做新衣',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '國王沒有新衣穿的時候，心情會怎麼樣？',
                        options: [
                            '很高興',
                            '心情不好',
                            '很驚喜',
                            '想睡覺'
                        ],
                        correct: 1,
                        explanation: '課文提到：「沒有新衣穿，就會心情不好。」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '在「國王做新衣」這課中，大臣是怎麼讓國王有新衣穿的？',
                        options: [
                            '每天去買新衣服',
                            '把國王穿過的衣服修改，例如改袖子、加衣領',
                            '叫國王自己做',
                            '跟國王說不用穿新衣'
                        ],
                        correct: 1,
                        explanation: '課文提到：「大臣找出國王穿過的衣服，又改袖子，又加衣領。」'
                    },
                    {
                        level: 2, // 推論層次
                        text: '國王後來為什麼也開始「動手做」？',
                        options: [
                            '因為大臣強迫他',
                            '因為他覺得大臣改的衣服很醜',
                            '因為大臣的改造讓他覺得很驚喜，越做越高興',
                            '因為他想把衣服賣掉'
                        ],
                        correct: 2,
                        explanation: '課文提到：「國王看了好驚喜，忍不住也一起動手做，越做越高興。」'
                    },
                    {
                        level: 2, // 推論層次
                        text: '課文最後說，國王「不再想著要穿新衣」了，為什麼？',
                        options: [
                            '因為他沒有錢了',
                            '因為大臣不幫他了',
                            '因為他發現設計衣服和分享，比「穿」新衣更快樂',
                            '因為天氣變熱了'
                        ],
                        correct: 2,
                        explanation: '國王後來「喜歡上設計衣服」，並「把快樂分享出去」。他找到了新的快樂來源，所以不再執著於「穿」新衣。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '你覺得大臣送給國王的「新衣」，真的是新的嗎？',
                        options: [
                            '是，是大臣買的',
                            '不是，是大臣用舊衣服改造的',
                            '是，是大臣自己做的',
                            '不知道，課文沒說'
                        ],
                        correct: 1,
                        explanation: '大臣是「找出國王穿過的衣服」來修改，所以嚴格來說不是「全新」的布料做的，但是一個「新」的設計。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '國王學會了「有不同的方法，可以讓自己開心」。想想看，除了穿新衣，還有什麼事可以讓你覺得開心？',
                        options: [
                            '跟朋友吵架',
                            '幫家人做家事',
                            '功課寫不完',
                            '弄壞東西'
                        ],
                        correct: 1,
                        explanation: '做一件有意義的事，比如幫忙家人，或是像國王一樣「分享」，都能帶來快樂。這題答案有很多可能，B選項是其中一個好例子。'
                    }
                ]
            },
            '4': {
                title: '第四課：水草下的呱呱',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '在「水草下的呱呱」這課中，「我」在哪裡？',
                        options: [
                            '水草上',
                            '水草下',
                            '你的腦袋瓜上',
                            '石頭上'
                        ],
                        correct: 1,
                        explanation: '第一句就說：「水草下的我啊！呱呱！」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '詩中的「我」說，如果「你」乖乖的，他會做什麼？',
                        options: [
                            '躲起來',
                            '大聲唱歌',
                            '輕輕跳上你的腦袋瓜',
                            '游走'
                        ],
                        correct: 2,
                        explanation: '課文最後提到：「說不定我會／輕輕跳上你的腦袋瓜」。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '「我」為什麼要請水草上的「你」不要再靠近？',
                        options: [
                            '因為「我」想睡覺',
                            '因為「我」很害羞',
                            '因為「我」擔心「你」不只想看還想要抓',
                            '因為「你」長得很奇怪'
                        ],
                        correct: 2,
                        explanation: '課文提到：「我擔心你／不只想看還想要抓。」這顯示了「我」的害怕。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '這首詩是從誰的視角寫的？',
                        options: [
                            '在岸上的人',
                            '水草',
                            '躲在水草下的青蛙或蝦蟆',
                            '一隻鳥'
                        ],
                        correct: 2,
                        explanation: '詩中提到「水草下的我」、「呱呱」、「蝦蟆還是青蛙」，很明顯是從青蛙(或蝦蟆)的角度來看事情。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '詩裡面的「我」最有可能"不是"什麼動物？',
                        options: [
                            '青蛙',
                            '蝦蟆',
                            '小鳥',
                            '會呱呱叫的動物'
                        ],
                        correct: 2,
                        explanation: '詩中提到「蝦蟆還是青蛙？」和「呱呱」叫，都指向蛙類，而且是在水草下。小鳥不會在水草下，叫聲通常也不是呱呱。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '「我」說如果「你」乖乖的，就會跳上你的腦袋瓜，證明你「頂呱呱」。這裡的「頂呱呱」是什麼意思？',
                        options: [
                            '頭上真的有青蛙',
                            '形容一個人很棒、很厲害',
                            '形容天氣很好',
                            '形容叫得很大聲'
                        ],
                        correct: 1,
                        explanation: '「頂呱呱」是一個稱讚別人的詞語，意思是「非常好」、「最棒的」。作者用了這個詞，也和青蛙的叫聲「呱呱」做了有趣的連結。'
                    }
                ]
            },
            '5': {
                title: '第五課：沙灘上的畫',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '為什麼沙灘看起來「好大好大」？',
                        options: [
                            '因為人很少',
                            '因為海水退得好遠好遠',
                            '因為天黑了',
                            '因為漲潮了'
                        ],
                        correct: 1,
                        explanation: '課文第一段提到：「海水退得好遠好遠，沙灘看起來好大好大。」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '在「沙灘上的畫」這課中，沙灘上的「畫」是由什麼組成的？',
                        options: [
                            '小真畫的圖',
                            '螃蟹的殼和貝殼',
                            '大家橫著走的腳印和螃蟹挖的小洞',
                            '海水沖上來的垃圾'
                        ],
                        correct: 2,
                        explanation: '課文最後小真說：「我們的腳印和螃蟹挖的小洞，好像美麗的畫。」'
                    },
                    {
                        level: 2, // 推論層次
                        text: '媽媽注意到螃蟹是怎麼走的，引導妹妹做了什麼事？',
                        options: [
                            '把螃蟹抓起來',
                            '學螃蟹走路',
                            '幫螃蟹拍照',
                            '把螃蟹趕走'
                        ],
                        correct: 1,
                        explanation: '媽媽問螃蟹怎麼走，妹妹接著說：「我知道，我們來學螃蟹走路吧！」'
                    },
                    {
                        level: 2, // 推論層次
                        text: '小真一家人為什麼要「橫著走」？',
                        options: [
                            '因為他們在比賽',
                            '因為沙灘很燙',
                            '因為路太窄',
                            '因為他們在學螃蟹走路'
                        ],
                        correct: 3,
                        explanation: '課文中，媽媽問螃蟹怎麼走，妹妹說「我們來學螃蟹走路吧！」，螃蟹是橫著走的。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '這課的「沙灘上的畫」有什麼特別的地方？',
                        options: [
                            '是用顏料畫的',
                            '是會被海水沖走的',
                            '是可以賣錢的',
                            '是永遠不會消失的'
                        ],
                        correct: 1,
                        explanation: '沙灘上的腳印和小洞，只要海水漲潮就會被沖掉。這是一幅短暫、自然的美麗圖畫。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '「夕陽把沙灘照得閃閃發亮」，這句話描寫的是什麼時候的景象？',
                        options: [
                            '早上',
                            '中午',
                            '傍晚',
                            '半夜'
                        ],
                        correct: 2,
                        explanation: '「夕陽」就是指傍晚時，太陽快下山的時候。'
                    }
                ]
            },
            '6': {
                title: '第六課：草叢裡的星星',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '這篇日記是在什麼時候去散步的？',
                        options: [
                            '放學後',
                            '吃過晚飯後',
                            '早上',
                            '半夜'
                        ],
                        correct: 1,
                        explanation: '課文提到：「吃過晚飯，全家人一起去散步。」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '在「草叢裡的星星」這課中，爸爸說的「星星」指的是什麼？',
                        options: [
                            '天上的星星',
                            '會發亮的石頭',
                            '螢火蟲',
                            '妹妹的髮夾'
                        ],
                        correct: 2,
                        explanation: '課文描述「小星星在草叢裡，一下子這邊亮，一下子那邊亮」，並且會「躲到妹妹的頭上」，這符合螢火蟲的特性。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '作者在哪裡找到「星星」的？',
                        options: [
                            '奶奶家的屋頂上',
                            '竹林裡',
                            '小溪兩旁的草叢裡',
                            '天空中'
                        ],
                        correct: 2,
                        explanation: '課文描述：「我們穿過屋後的竹林，竹林盡頭是小溪，小溪兩旁長滿了草。」作者接著說在「草叢裡」看見了星星。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '妹妹為什麼為了「新朋友」一動也不動？',
                        options: [
                            '因為她很害怕',
                            '因為她睡著了',
                            '因為她很得意，怕一動「星星」就飛走了',
                            '因為爸爸叫她不准動'
                        ],
                        correct: 2,
                        explanation: '課文說妹妹「好得意呀！」，表示她很開心有「星星」停在她頭上，為了讓「新朋友」多待一會兒，所以不敢亂動。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '這篇日記的天氣是什麼？',
                        options: [
                            '晴天',
                            '雨天',
                            '陰天',
                            '颱風天'
                        ],
                        correct: 0,
                        explanation: '課文一開始就寫了日記的格式：「0月0日 星期五 天氣：晴」。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '作者說「小星星在小溪旁，聚成一朵又一朵發光的雲」，這是使用了什麼方法讓句子更生動？',
                        options: [
                            '把螢火蟲說成在生氣',
                            '把螢火蟲比喻成發光的雲',
                            '說螢火蟲會說話',
                            '說螢火蟲是假的'
                        ],
                        correct: 1,
                        explanation: '作者把「聚集的螢火蟲」比喻成「發光的雲」，這是一種譬喻法，讓讀者更容易想像那美麗的畫面。'
                    }
                ]
            },
            '7': {
                title: '第七課：不一樣的美食',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '在「不一樣的美食」這課中，小星帶的「竹筒飯」裡有什麼特別的含意？',
                        options: [
                            '只有竹子的香味',
                            '有竹子的香味、奶奶的愛心和祖先的故事',
                            '只有奶奶的愛心',
                            '只有祖先的故事'
                        ],
                        correct: 1,
                        explanation: '小星說：「這是竹筒飯，有竹子的香味，有奶奶的愛心，還有祖先的故事。」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '明光帶的是哪一國的美食？',
                        options: [
                            '客家美食',
                            '原住民美食',
                            '越南春捲',
                            '竹筒飯'
                        ],
                        correct: 2,
                        explanation: '課文最後提到：「我帶的是越南春捲，也有好故事呢！」'
                    },
                    {
                        level: 2, // 推論層次
                        text: '小花、小星和明光帶的美食，有什麼共同點？',
                        options: [
                            '都是甜的',
                            '都是竹筒裝的',
                            '都是越南來的',
                            '都代表了自己家鄉或族群的文化故事'
                        ],
                        correct: 3,
                        explanation: '竹筒飯（原住民）、艾粄（客家）、越南春捲（越南）這三樣美食，都連結了它們的文化和故事。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '為什麼小花和小星都希望下星期二快點到來？',
                        options: [
                            '因為那天要校外教學',
                            '因為那天是美食分享日',
                            '因為那天不用考試',
                            '因為明光的家人要來教大家做越南春捲'
                        ],
                        correct: 3,
                        explanation: '課文最後提到：「下星期二班上的活動，正好是明光的家人要來教大家做越南春捲」。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '小花說客家人在清明節吃艾粄，除了好吃，還有什麼功用？',
                        options: [
                            '可以保平安',
                            '可以當玩具',
                            '可以考試一百分',
                            '可以拿來拜拜'
                        ],
                        correct: 0,
                        explanation: '小花說：「媽媽說，客家人會在清明節吃艾粄，不但好吃，還可以保平安。」'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '為什麼大家會期待明光的家人來教大家做越南春捲？',
                        options: [
                            '因為可以不用上課',
                            '因為可以認識和體驗不一樣的文化美食',
                            '因為老師說不期待的人要罰站',
                            '因為春捲很貴'
                        ],
                        correct: 1,
                        explanation: '從課文中大家開心分享自己的美食來看，他們對於能親手製作並了解另一種文化的美食（越南春捲）感到很有興趣。'
                    }
                ]
            },
            '8': {
                title: '第八課：美食分享日',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '在「美食分享日」這課中，明光媽媽介紹的「米紙」有什麼特性？',
                        options: [
                            '泡水會變硬',
                            '泡水一下就會變軟',
                            '是白色的紙，不能吃',
                            '要用火烤'
                        ],
                        correct: 1,
                        explanation: '明光說：「這是米紙，只要泡一下水就會變軟。」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '明光媽媽用什麼來包春捲的食材？',
                        options: [
                            '竹筒',
                            '艾草',
                            '泡軟的米紙',
                            '便當盒'
                        ],
                        correct: 2,
                        explanation: '課文提到：「用泡軟的米紙包食材，就可以吃了。」'
                    },
                    {
                        level: 2, // 推論層次
                        text: '越南春捲裡面包了哪些食材？',
                        options: [
                            '只有青菜',
                            '只有米線',
                            '蝦子、米線和各種青菜',
                            '竹筒飯和艾粄'
                        ],
                        correct: 2,
                        explanation: '課文提到，明光的媽媽在米紙上「放進蝦子、米線和各種青菜」。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '大家一邊吃春捲，一邊聽明光媽媽說了什麼？',
                        options: [
                            '越南的天氣',
                            '她小時候的生活故事',
                            '春捲的價錢',
                            '學校的規定'
                        ],
                        correct: 1,
                        explanation: '課文提到：「大家一邊吃，一邊聽明光媽媽說小時候的生活，知道更多不一樣的故事。」'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '小花說：「有故事好好吃。」老師卻說：「是有了故事，春捲更美味了。」這兩句話是什麼意思？',
                        options: [
                            '春捲本身沒有味道，故事才有味道',
                            '食物本身已經很好吃，但如果能了解它背後的文化故事，會讓人覺得這食物更有意義、更美味',
                            '一定要邊聽故事邊吃，不然會拉肚子',
                            '老師在糾正小花，說她說錯了'
                        ],
                        correct: 1,
                        explanation: '老師的意思是，食物的美味不只來自味覺，也來自心靈的感受。了解了食物的文化和故事，會讓我們在品嘗時有更豐富的體驗。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '第七課和第八課是相關的。這兩課主要想傳達什麼觀念？',
                        options: [
                            '越南春捲最好吃',
                            '應該要尊重和欣賞不同的飲食文化',
                            '吃飯時間不要說話',
                            '不要帶便當到學校'
                        ],
                        correct: 1,
                        explanation: '這兩課透過介紹竹筒飯、艾粄、越南春捲等不同美食，讓我們看到每種食物背後都有自己的文化和故事，我們應該抱持開放的心胸去欣賞和尊重。'
                    }
                ]
            },
            '9': {
                title: '第九課：好味道',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '在「好味道」這首詩中，「爸爸幫米粒泡澡」後，米粒變成了什麼樣子？',
                        options: [
                            '很想玩水',
                            '急著想玩水',
                            '顆顆蒸得白又胖',
                            '緊緊黏在一起'
                        ],
                        correct: 2,
                        explanation: '詩中提到：「送進發熱的浴室，／顆顆蒸得白又胖。」這是在形容煮飯。'
                    },
                    {
                        level: 1, // 文義理解
                        text: '詩中「點名了！」點到了哪些食材？',
                        options: [
                            '小黃瓜和紅蘿蔔',
                            '海苔、米飯、蛋皮、蔬菜',
                            '米粒和海苔',
                            '只有蛋皮和蔬菜'
                        ],
                        correct: 1,
                        explanation: '詩中提到：「海苔、米飯搶先到，／蛋皮、蔬菜接著來」。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '這首詩描寫的「好味道」最有可能是什麼食物？',
                        options: [
                            '炒飯',
                            '壽司（捲壽司）',
                            '燙青菜',
                            '稀飯'
                        ],
                        correct: 1,
                        explanation: '從「海苔、米飯」、「蛋皮、蔬菜」、「捲哪捲」這些線索可以推論，這是在做捲壽司。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '為什麼作者說「這是我最愛的味道」？',
                        options: [
                            '因為他只愛吃壽司',
                            '因為這是全家人一起細心製作的味道',
                            '因為媽媽煮的最好吃',
                            '因為爸爸買的很貴'
                        ],
                        correct: 1,
                        explanation: '詩的最後提到「我們細心的捲哪捲」，和「把全家人緊緊黏在一起」，表示這味道包含了全家人的愛與合作。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '作者說「把全家人緊緊黏在一起」，這句話有什麼特別的意思？',
                        options: [
                            '形容壽司捲得很緊',
                            '形容全家人一起做壽司，感情很好、很緊密',
                            '兩個意思都有',
                            '形容天氣很熱，大家都黏在一起'
                        ],
                        correct: 2,
                        explanation: '這是一句「雙關語」。字面上是說把食材捲起來（像家人黏在一起），同時也比喻全家人一起活動、分享美食，讓彼此的感情更緊密。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '「媽媽給小黃瓜沖澡」，這句話用了什麼方式讓句子更生動？',
                        options: [
                            '把小黃瓜當作人一樣，說它在「沖澡」',
                            '說小黃瓜會哭',
                            '說小黃瓜會跳',
                            '說小黃瓜是熱的'
                        ],
                        correct: 0,
                        explanation: '這是「擬人法」，把洗小黃瓜這個動作，說成是幫小黃瓜「沖澡」，讓讀者覺得很有趣。'
                    }
                ]
            },
            '10': {
                title: '第十課：加加減減',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '表弟說上學讀書很好玩，因為他學會了什麼？',
                        options: [
                            '玩猜字謎',
                            '問數學題',
                            '認識了很多字',
                            '抓頭和嘟嘴'
                        ],
                        correct: 2,
                        explanation: '課文第一段提到：「他說上學讀書真好玩，認識了很多字。」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '「一加一」的字謎答案是什麼？',
                        options: ['二', '王', '三', '十'],
                        correct: 1,
                        explanation: '姐姐提示「王」，表示「一」加「一」是「王」。'
                    },
                    {
                        level: 1, // 文義理解
                        text: '在「加加減減」這課中，「一百減一」的字謎，答案是什麼字？',
                        options: ['九十九', '王', '三', '白'],
                        correct: 3,
                        explanation: '「一百」合起來是「百」這個字，「減一」就是把「百」字上面的「一」拿掉，剩下「白」。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '為什麼表弟一開始會生氣，說表哥都在問「數學題」？',
                        options: [
                            '因為表哥真的在考他數學',
                            '因為他數學不好',
                            '因為他沒聽懂這是「字謎」，以為是在問數學的加減法',
                            '因為表哥不給他糖果'
                        ],
                        correct: 2,
                        explanation: '表弟把「一加一」當成數學 1+1=2，沒想到是字謎「王」，所以他才會誤會。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '表弟是怎麼猜到「一百減一」是「白」的？',
                        options: [
                            '他自己想到的',
                            '表哥告訴他的',
                            '他看到姐姐寫的「王」和「三」的提示，懂了字謎的玩法',
                            '他亂猜的'
                        ],
                        correct: 2,
                        explanation: '姐姐寫下「王」和「三」當作提示，讓表弟「突然」懂了，所以他才能搶著回答「白」。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '姐姐寫下「王」和「三」，是想提示表弟哪兩個字謎的答案？',
                        options: [
                            '「一加一」是「王」，「一百減一」是「三」',
                            '「一加一」是「王」，「一減一」是「三」',
                            '「一加一」是「三」，「一減一」是「王」',
                            '「一減一」是「三」，「一百減一」是「王」'
                        ],
                        correct: 1,
                        explanation: '姐姐是想提示表弟，字謎的思考方式。「一」加「一」(1+1)，可以想成是「王」字。而「一減一」(1-1)，可以想成是「王」字減去中間的「一」橫，變成「三」字。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '請你也來猜一個字謎：「十加十」是什麼字？',
                        options: ['二十', '田', '王', '古'],
                        correct: 1,
                        explanation: '「十」加「十」，把兩個「十」字合起來，變成「田」字。'
                    }
                ]
            },
            '11': {
                title: '第十一課：奇怪的門',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '「人」走進這扇奇怪的門，會發生什麼事？',
                        options: [
                            '閒得發慌',
                            '卡在門中間',
                            '閃一下就不見',
                            '變成主播'
                        ],
                        correct: 2,
                        explanation: '詩中提到：「人走進去，／閃一下就不見。」（組成了「閃」字）'
                    },
                    {
                        level: 1, // 文義理解
                        text: '「月亮」一進去這扇門會怎麼樣？',
                        options: [
                            '立刻閒得發慌',
                            '闖來闖去闖不出來',
                            '卡在門中間',
                            '問東問西'
                        ],
                        correct: 0,
                        explanation: '詩中提到：「月亮一進去，／立刻閒得發慌。」（組成了「閒」字）'
                    },
                    {
                        level: 1, // 文義理解
                        text: '「嘴巴」靠近大門口會做什麼？',
                        options: [
                            '唱歌',
                            '哭出來',
                            '閃一下就不見',
                            '好奇的問東問西'
                        ],
                        correct: 3,
                        explanation: '詩中提到：「嘴巴靠近大門口，／好奇的問東問西：」（組成了「問」字）'
                    },
                    {
                        level: 1, // 文義理解
                        text: '在「奇怪的門」這首詩中，「太陽想進門」結果怎麼了？',
                        options: ['閃一下就不見', '閒得發慌', '變成主播', '卡在門中間'],
                        correct: 3,
                        explanation: '詩中提到：「太陽想進門，／用力擠呀擠，／竟然卡在門中間。」（組成了「間」字）'
                    },
                    {
                        level: 2, // 推論層次
                        text: '這首詩裡，把「耳」放進「門」裡，會變成什麼字？',
                        options: ['閃', '閒', '闖', '聞'],
                        correct: 3,
                        explanation: '詩中說「耳朵走進門，／變成主播，播報大新聞」，主播報新聞就是「聞」，由「門」和「耳」組成。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '「馬跑進去，／闖來闖去闖不出來。」這句話是利用了哪個字的組合？',
                        options: ['「門」和「人」', '「門」和「馬」', '「門」和「日」', '「門」和「口」'],
                        correct: 1,
                        explanation: '「門」裡面一個「馬」，合起來就是「闖」字。詩中用「闖來闖去」來形容這個字，非常有趣。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '這首詩為什麼說這扇門「好奇怪」？',
                        options: [
                            '因為門會動',
                            '因為門會說話',
                            '因為任何東西靠近或進去，都會和「門」組合成一個新字',
                            '因為門打不開'
                        ],
                        correct: 2,
                        explanation: '這首詩其實是在玩「合體字」的字謎遊戲，所有東西（人、月、馬、耳、日、口）碰到「門」，都組成了新字（閃、閒、闖、聞、間、問）。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '詩的最後說「裡頭一定住著大妖怪！」是為什麼？',
                        options: [
                            '作者真的很害怕',
                            '作者在開玩笑，因為這個「門」太奇怪了，什麼東西進去都會變樣子',
                            '作者真的看到妖怪了',
                            '作者的媽媽告訴他的'
                        ],
                        correct: 1,
                        explanation: '這是一種幽默的想像。因為這個「門」會讓所有東西都「變身」(組合成新字)，作者就開玩笑說裡面是不是住了會施魔法的妖怪。'
                    }
                ]
            },
            '12': {
                title: '第十二課：詠鵝',
                questions: [
                    {
                        level: 1, // 文義理解
                        text: '「詠鵝」這首詩是誰在幾歲的時候作的？',
                        options: [
                            '姐姐，七歲',
                            '媽媽，年齡不詳',
                            '駱賓王，七歲',
                            '作者，七歲'
                        ],
                        correct: 2,
                        explanation: '課文中媽媽說：「詩人駱賓王作這首詩的時候才七歲呢！」'
                    },
                    {
                        level: 1, // 文義理解
                        text: '駱賓王的「詠鵝」詩中，白鵝是用什麼在撥水？',
                        options: [
                            '白毛',
                            '脖子',
                            '紅掌',
                            '肚皮'
                        ],
                        correct: 2,
                        explanation: '詩句「紅掌撥清波」中，「紅掌」就是指紅色的腳掌。'
                    },
                    {
                        level: 1, // 文義理解
                        text: '姐姐作的詩描述了鵝的什麼新動作？',
                        options: [
                            '曲項向天歌',
                            '白毛浮綠水',
                            '倒立在水中，翻跟頭',
                            '紅掌撥清波'
                        ],
                        correct: 2,
                        explanation: '姐姐說：「鵝、鵝、鵝，倒立在水中。翻個大跟頭，肚皮向天空。」'
                    },
                    {
                        level: 2, // 推論層次
                        text: '駱賓王的詩句「曲項向天歌」是什麼意思？',
                        options: [
                            '鵝把脖子伸進水裡',
                            '鵝伸長彎彎的脖子對著天空唱歌',
                            '鵝在水裡翻跟頭',
                            '鵝的腳在撥水'
                        ],
                        correct: 1,
                        explanation: '「曲項」是彎彎的脖子，「向天歌」是對著天空唱歌。'
                    },
                    {
                        level: 2, // 推論層次
                        text: '姐姐為什麼也作了一首「詠鵝」詩？',
                        options: [
                            '因為老師叫她寫作業',
                            '因為她看到鵝「倒立在水中」、「翻跟頭」的樣子，和駱賓王的詩不一樣',
                            '因為她想跟駱賓王比賽',
                            '因為媽媽逼她的'
                        ],
                        correct: 1,
                        explanation: '姐姐看到鵝做了新的動作（倒立、翻跟頭），這是駱賓王的詩沒有寫到的，所以她就模仿駱賓王的格式，寫出自己看到的景象。'
                    },
                    {
                        level: 3, // 評鑑層次
                        text: '媽媽說：「姐姐變成小詩人了！」這句話是什麼意思？',
                        options: [
                            '姐姐真的改行當詩人了',
                            '媽媽在稱讚姐姐很有觀察力，並且能把看到的景象用詩句表達出來',
                            '媽媽在笑姐姐亂寫',
                            '姐姐的名字叫小詩'
                        ],
                        correct: 1,
                        explanation: '媽媽這是在鼓勵和稱讚姐姐，肯定她能像詩人一樣觀察事物並進行創作。'
                    },
                    {
                        level: 4, // 賞析創意
                        text: '姐姐和駱賓王作詩有什麼共同點？',
                        options: [
                            '他們都七歲',
                            '他們都只會寫鵝',
                            '他們都是仔細觀察後，才把看到的景象寫出來',
                            '他們都喜歡翻跟頭'
                        ],
                        correct: 2,
                        explanation: '駱賓王看到鵝「向天歌」、「撥清波」；姐姐看到鵝「翻跟頭」、「肚皮向天」。他們都是把自己「看到」的景象寫成詩。'
                    }
                ]
            }
        };

        // --- 應用程式狀態 ---
        let currentLesson = null;
        let currentQuestionIndex = 0;
        let score = 0;
        let quizInProgress = false;
        let selectedAnswerIndex = null;
        const contentArea = document.getElementById('content-area');

        // --- 渲染函式 ---

        /** 渲染主選單（課數選擇）*/
        function renderLessonSelection() {
            quizInProgress = false;
            currentLesson = null;
            currentQuestionIndex = 0;
            score = 0;

            let lessonButtonsHtml = '';
            for (const lessonId in quizData) {
                lessonButtonsHtml += `
                    <button class="btn-lesson" onclick="selectLesson('${lessonId}')">
                        ${quizData[lessonId].title} (${quizData[lessonId].questions.length}題)
                    </button>
                `;
            }

            contentArea.innerHTML = `
                <h1 class="text-3xl font-bold text-center text-blue-800 mb-8">課文理解測驗</h1>
                <p class="text-center text-gray-600 mb-8">請選擇你想挑戰的課數：</p>
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                    ${lessonButtonsHtml}
                </div>
            `;
        }

        /** 渲染問題畫面 */
        function renderQuestion() {
            const lesson = currentLesson;
            const question = lesson.questions[currentQuestionIndex];
            const questionCount = lesson.questions.length;
            // 修正分數計算，確保是整數
            const pointsPerQuestion = 100 / questionCount;

            let optionsHtml = '';
            question.options.forEach((option, index) => {
                optionsHtml += `
                    <button id="option-${index}" class="option-btn" onclick="checkAnswer(${index})">
                        <div class="flex items-center">
                            <span class="keycap">${String.fromCharCode(65 + index)}</span>
                            <span class="text-left flex-1">${option}</span>
                        </div>
                    </button>
                `;
            });

            contentArea.innerHTML = `
                <!-- 進度條和分數 -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-2 text-gray-700">
                        <span class="text-lg font-semibold">${lesson.title}</span>
                        <span class="text-lg font-bold text-blue-600">分數: ${Math.round(score)}</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-4">
                        <div class="bg-blue-500 h-4 rounded-full transition-all duration-300" style="width: ${((currentQuestionIndex + 1) / questionCount) * 100}%"></div>
                    </div>
                    <div class="text-right text-sm text-gray-500 mt-1">第 ${currentQuestionIndex + 1} / ${questionCount} 題</div>
                </div>

                <!-- 題目 -->
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">${question.text}</h2>

                <!-- 選項 -->
                <div id="options-container" class="flex flex-col">
                    ${optionsHtml}
                </div>

                <!-- 回饋區 (預設隱藏) -->
                <div id="feedback-area" class="mt-6 p-4 rounded-lg hidden"></div>

                <!-- 下一題按鈕 (預設隱藏) -->
                <div class="text-center mt-8">
                    <button id="next-btn" class="btn btn-primary hidden" onclick="nextQuestion()">
                        ${(currentQuestionIndex === questionCount - 1) ? '查看分數' : '下一題'}
                    </button>
                </div>
            `;
        }

        /** 渲染最終分數畫面 */
        function renderFinalScore() {
            quizInProgress = false;
            const finalScore = Math.round(score); // 確保最終分數為整數
            contentArea.innerHTML = `
                <div class="text-center">
                    <h1 class="text-3xl font-bold text-blue-800 mb-4">測驗完成！</h1>
                    <p class="text-5xl font-extrabold text-green-600 mb-8">${finalScore}</p>
                    <p class="text-xl text-gray-700 mb-10">你獲得了 100 分中的 ${finalScore} 分！</p>
                    <button class="btn btn-primary" onclick="renderLessonSelection()">
                        返回主選單
                    </button>
                </div>
            `;
        }

        // --- 邏輯函式 ---

        /** 選擇課數 */
        window.selectLesson = (lessonId) => {
            currentLesson = quizData[lessonId];
            quizInProgress = true;
            score = 0; // 選擇新課程時重置分數
            currentQuestionIndex = 0; // 選擇新課程時重置題號
            renderQuestion();
        }

        /** 檢查答案 */
        window.checkAnswer = (selectedIndex) => {
            if (selectedAnswerIndex !== null) return; // 防止重複點擊

            selectedAnswerIndex = selectedIndex;
            const lesson = currentLesson;
            const question = lesson.questions[currentQuestionIndex];
            const correctIndex = question.correct;
            const questionCount = lesson.questions.length;
            const pointsPerQuestion = 100 / questionCount;

            const feedbackArea = document.getElementById('feedback-area');
            const nextBtn = document.getElementById('next-btn');

            // 禁用所有選項按鈕
            for (let i = 0; i < question.options.length; i++) {
                document.getElementById(`option-${i}`).disabled = true;
            }

            // 檢查答案
            if (selectedIndex === correctIndex) {
                // 答對
                score += pointsPerQuestion;
                document.getElementById(`option-${selectedIndex}`).classList.add('correct');
                feedbackArea.innerHTML = `<p class="text-xl font-bold text-green-700">答對了！</p>`;
                feedbackArea.className = "mt-6 p-4 rounded-lg bg-green-100 border border-green-300";
            } else {
                // 答錯
                document.getElementById(`option-${selectedIndex}`).classList.add('wrong');
                if (correctIndex !== undefined) {
                    document.getElementById(`option-${correctIndex}`).classList.add('correct');
                }
                
                let feedbackHtml = `<p class="text-xl font-bold text-red-700">答錯了！</p>`;
                feedbackHtml += `<p class="text-md text-gray-800 mt-2">正確答案是： <strong>${String.fromCharCode(65 + correctIndex)}. ${question.options[correctIndex]}</strong></p>`;
                
                // 顯示詳解
                if (question.explanation) {
                    feedbackHtml += `<hr class="my-3"><p class="text-md text-gray-700"><strong>詳解：</strong>${question.explanation}</p>`;
                }
                
                feedbackArea.innerHTML = feedbackHtml;
                feedbackArea.className = "mt-6 p-4 rounded-lg bg-red-100 border border-red-300";
            }

            // 更新分數顯示 (立即)
            document.querySelector('.text-lg.font-bold.text-blue-600').textContent = `分數: ${Math.round(score)}`;

            // 顯示回饋和下一題按鈕
            feedbackArea.classList.remove('hidden');
            nextBtn.classList.remove('hidden');
        }

        /** 進行下一題 */
        window.nextQuestion = () => {
            selectedAnswerIndex = null; // 重置已選答案
            currentQuestionIndex++;

            if (currentQuestionIndex < currentLesson.questions.length) {
                renderQuestion();
            } else {
                renderFinalScore();
            }
        }

        // --- 程式啟動 ---
        document.addEventListener('DOMContentLoaded', renderLessonSelection);
    </script>
</body>
</html>